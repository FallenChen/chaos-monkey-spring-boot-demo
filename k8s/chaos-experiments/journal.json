{
  "chaoslib-version": "1.0.0",
  "platform": "Darwin-18.2.0-x86_64-i386-64bit",
  "node": "somni-pro",
  "experiment": {
    "version": "1.0.0",
    "title": "Pod should be automatically killed and restarted when unhealthy",
    "description": "Can we trust Kubernetes to restart our microservice when it detects it is unhealthy?",
    "tags": [
      "microservice",
      "kubernetes",
      "python"
    ],
    "steady-state-hypothesis": {
      "title": "Services are all available and healthy",
      "probes": [
        {
          "name": "api-gateway-must-still-respond",
          "provider": {
            "type": "http",
            "url": "http://gateway-master.chaos.codecentric.io/startpage/cb",
            "timeout": [
              0.25,
              0.5
            ]
          },
          "tolerance": 200,
          "type": "probe"
        }
      ]
    },
    "method": [
      {
        "type": "probe",
        "name": "all-services-are-healthy",
        "tolerance": true,
        "provider": {
          "type": "python",
          "module": "chaosk8s.probes",
          "func": "all_microservices_healthy",
          "arguments": {
            "ns": "shoppingdemo"
          }
        }
      },
      {
        "type": "action",
        "name": "deploy_pumba_as_daemon_set",
        "provider": {
          "type": "process",
          "path": "kubectl",
          "arguments": {
            "apply": "",
            "-f": "pumba-kill-pods.yaml"
          }
        },
        "pauses": {
          "after": 5
        }
      }
    ],
    "rollbacks": [
      {
        "type": "action",
        "name": "delete_pumba_as_daemon_set",
        "provider": {
          "type": "process",
          "path": "kubectl",
          "arguments": {
            "delete": "",
            "-f": "pumba-kill-pods.yaml"
          }
        }
      }
    ],
    "dry": false
  },
  "start": "2019-02-27T21:10:04.243591",
  "status": "completed",
  "deviated": false,
  "steady_states": {
    "before": {
      "steady_state_met": true,
      "probes": [
        {
          "activity": {
            "name": "api-gateway-must-still-respond",
            "provider": {
              "type": "http",
              "url": "http://gateway-master.chaos.codecentric.io/startpage/cb",
              "timeout": [
                0.25,
                0.5
              ]
            },
            "tolerance": 200,
            "type": "probe"
          },
          "output": {
            "status": 200,
            "headers": {
              "Server": "nginx/1.15.8",
              "Date": "Wed, 27 Feb 2019 21:10:04 GMT",
              "Content-Type": "application/json;charset=UTF-8",
              "Transfer-Encoding": "chunked",
              "Connection": "keep-alive",
              "Vary": "Accept-Encoding",
              "Content-Encoding": "gzip"
            },
            "body": "{\"fashionResponse\":{\"responseType\":\"ERROR\",\"products\":[]},\"toysResponse\":{\"responseType\":\"ERROR\",\"products\":[]},\"hotDealsResponse\":{\"responseType\":\"REMOTE_SERVICE\",\"products\":[{\"id\":7,\"name\":\"Thermal Winter Warm Hot Heat Socks\",\"category\":\"FASHION\"},{\"id\":8,\"name\":\"RC Quadcopter Drone with 2.0MP Camera Live\",\"category\":\"TOYS\"},{\"id\":9,\"name\":\"Spring Boot 2: Moderne Softwareentwicklung mit Spring 5\",\"category\":\"BOOKS\"}]},\"duration\":163,\"statusFashion\":\"ERROR\",\"statusToys\":\"ERROR\",\"statusHotDeals\":\"REMOTE_SERVICE\"}"
          },
          "status": "succeeded",
          "start": "2019-02-27T21:10:04.244312",
          "end": "2019-02-27T21:10:04.484550",
          "duration": 0.240238,
          "tolerance_met": true
        }
      ]
    },
    "after": {
      "steady_state_met": true,
      "probes": [
        {
          "activity": {
            "name": "api-gateway-must-still-respond",
            "provider": {
              "type": "http",
              "url": "http://gateway-master.chaos.codecentric.io/startpage/cb",
              "timeout": [
                0.25,
                0.5
              ]
            },
            "tolerance": 200,
            "type": "probe"
          },
          "output": {
            "status": 200,
            "headers": {
              "Server": "nginx/1.15.8",
              "Date": "Wed, 27 Feb 2019 21:10:10 GMT",
              "Content-Type": "application/json;charset=UTF-8",
              "Transfer-Encoding": "chunked",
              "Connection": "keep-alive",
              "Vary": "Accept-Encoding",
              "Content-Encoding": "gzip"
            },
            "body": "{\"fashionResponse\":{\"responseType\":\"REMOTE_SERVICE\",\"products\":[{\"id\":4,\"name\":\"Bob Mailor Slim Jeans\",\"category\":\"FASHION\"},{\"id\":5,\"name\":\"Lewi's Jeanshose 511 Slim Fit\",\"category\":\"FASHION\"},{\"id\":6,\"name\":\"Urban Classics T-Shirt Shaped Long Tee\",\"category\":\"FASHION\"}]},\"toysResponse\":{\"responseType\":\"REMOTE_SERVICE\",\"products\":[{\"id\":1,\"name\":\"LEGO Star Wars Yodas Hut\",\"category\":\"TOYS\"},{\"id\":2,\"name\":\"LEGO Star Wars Millennium Falcon\",\"category\":\"TOYS\"},{\"id\":3,\"name\":\"LEGO Star Wars Imperial Tie Fighter\",\"category\":\"TOYS\"}]},\"hotDealsResponse\":{\"responseType\":\"REMOTE_SERVICE\",\"products\":[{\"id\":7,\"name\":\"Thermal Winter Warm Hot Heat Socks\",\"category\":\"FASHION\"},{\"id\":8,\"name\":\"RC Quadcopter Drone with 2.0MP Camera Live\",\"category\":\"TOYS\"},{\"id\":9,\"name\":\"Spring Boot 2: Moderne Softwareentwicklung mit Spring 5\",\"category\":\"BOOKS\"}]},\"duration\":45,\"statusFashion\":\"REMOTE_SERVICE\",\"statusToys\":\"REMOTE_SERVICE\",\"statusHotDeals\":\"REMOTE_SERVICE\"}"
          },
          "status": "succeeded",
          "start": "2019-02-27T21:10:09.992934",
          "end": "2019-02-27T21:10:10.087777",
          "duration": 0.094843,
          "tolerance_met": true
        }
      ]
    }
  },
  "run": [
    {
      "activity": {
        "type": "probe",
        "name": "all-services-are-healthy",
        "tolerance": true,
        "provider": {
          "type": "python",
          "module": "chaosk8s.probes",
          "func": "all_microservices_healthy",
          "arguments": {
            "ns": "shoppingdemo"
          }
        }
      },
      "output": true,
      "status": "succeeded",
      "start": "2019-02-27T21:10:04.484927",
      "end": "2019-02-27T21:10:04.718766",
      "duration": 0.233839
    },
    {
      "activity": {
        "type": "action",
        "name": "deploy_pumba_as_daemon_set",
        "provider": {
          "type": "process",
          "path": "kubectl",
          "arguments": {
            "apply": "",
            "-f": "pumba-kill-pods.yaml"
          }
        },
        "pauses": {
          "after": 5
        }
      },
      "output": {
        "status": 0,
        "stdout": "daemonset.extensions \"pumba\" created\n",
        "stderr": ""
      },
      "status": "succeeded",
      "start": "2019-02-27T21:10:04.718915",
      "end": "2019-02-27T21:10:04.989824",
      "duration": 0.270909
    }
  ],
  "rollbacks": [
    {
      "activity": {
        "type": "action",
        "name": "delete_pumba_as_daemon_set",
        "provider": {
          "type": "process",
          "path": "kubectl",
          "arguments": {
            "delete": "",
            "-f": "pumba-kill-pods.yaml"
          }
        }
      },
      "output": {
        "status": 0,
        "stdout": "daemonset.extensions \"pumba\" deleted\n",
        "stderr": ""
      },
      "status": "succeeded",
      "start": "2019-02-27T21:10:10.088295",
      "end": "2019-02-27T21:10:16.336446",
      "duration": 6.248151
    }
  ],
  "end": "2019-02-27T21:10:16.336576",
  "duration": 12.108889102935791
}